<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº§å“è¯¦æƒ… - æ¬£ä¸ç”œ</title>
    <script src="./js/tailwind.3.4.17.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="min-h-screen bg-gray-100 flex flex-col">
    <!-- Header -->
    <header class="bg-gray-800 text-white py-3 shadow-md">
        <div class="container mx-auto px-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <a href="index.html" class="flex items-center gap-3 text-white no-underline">
                    <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center overflow-hidden">
                        <span class="text-amber-600 font-bold text-sm">æ¬£ä¸ç”œ</span>
                    </div>
                    <span class="text-lg font-semibold">æ¬£ä¸ç”œ</span>
                </a>
            </div>
            <a href="index.html" class="text-sm text-gray-300 hover:text-white">â† è¿”å›é¦–é¡µ</a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 py-8">
        <div class="container mx-auto px-4 max-w-2xl">
            <!-- Loading State -->
            <div id="loadingState" class="loading">
                åŠ è½½ä¸­...
            </div>

            <!-- Error State -->
            <div id="errorState" class="hidden text-center py-12">
                <div class="text-6xl mb-4">ğŸ˜•</div>
                <h2 class="text-xl font-bold text-gray-700 mb-2">äº§å“æœªæ‰¾åˆ°</h2>
                <p class="text-gray-500 mb-4">æŠ±æ­‰ï¼Œæ‚¨æŸ¥çœ‹çš„äº§å“ä¸å­˜åœ¨æˆ–å·²ä¸‹æ¶ã€‚</p>
                <a href="index.html" class="inline-block px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                    è¿”å›é¦–é¡µ
                </a>
            </div>

            <!-- Product Detail -->
            <div id="productDetail" class="hidden bg-white rounded-lg shadow-sm overflow-hidden">
                <div class="p-6">
                    <!-- Product Header -->
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h1 id="productName" class="text-2xl font-bold text-gray-800"></h1>
                            <p id="productCategory" class="text-sm text-gray-500 mt-1"></p>
                        </div>
                        <span id="stockStatus" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                    </div>

                    <!-- Price -->
                    <div id="priceSection" class="mb-6">
                        <span class="text-3xl font-bold text-red-500">Â¥<span id="productPrice"></span></span>
                    </div>

                    <!-- Description -->
                    <div class="mb-6">
                        <h3 class="text-sm font-semibold text-gray-600 mb-2">å•†å“æè¿°</h3>
                        <p id="productDescription" class="text-gray-700"></p>
                    </div>

                    <!-- Info -->
                    <div class="border-t pt-4 text-sm text-gray-500">
                        <p>å•†å“ID: <span id="productId"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-4 mt-auto">
        <div class="container mx-auto px-4 text-center text-sm">
            ä¸€è·¯åŒè¡Œï¼Œå…±åŒè§è¯æ¢¦æƒ³çš„åŠ›é‡
        </div>
    </footer>

    <script>
        // API Base URL
        const API_BASE = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:9111'
            : '';

        document.addEventListener('DOMContentLoaded', async function() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');

            if (!productId) {
                showError();
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/products/${productId}`);
                if (!response.ok) {
                    throw new Error('Product not found');
                }
                const product = await response.json();
                displayProduct(product);
            } catch (error) {
                console.error('Error fetching product:', error);
                showError();
            }
        });

        function displayProduct(product) {
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('productDetail').classList.remove('hidden');

            document.getElementById('productName').textContent = product.name;
            document.getElementById('productCategory').textContent = product.category;
            document.getElementById('productPrice').textContent = product.price.toFixed(2);
            document.getElementById('productDescription').textContent = product.description;
            document.getElementById('productId').textContent = product.product_id;

            // Update page title
            document.title = `${product.name} - æ¬£ä¸ç”œ`;

            // Stock status
            const stockEl = document.getElementById('stockStatus');
            if (product.in_stock) {
                stockEl.textContent = 'æœ‰è´§';
                stockEl.className = 'px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-700';
            } else {
                stockEl.textContent = 'ç¼ºè´§';
                stockEl.className = 'px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-700';
            }

            // Hide price section if price is 0
            if (product.price === 0) {
                document.getElementById('priceSection').classList.add('hidden');
            }
        }

        function showError() {
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('errorState').classList.remove('hidden');
        }
    </script>
</body>
</html>

